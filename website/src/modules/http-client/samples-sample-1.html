<pre xmlns="http://www.w3.org/1999/xhtml">
<span class="nxml-processing-instruction-delimiter">&lt;?</span><span class="nxml-processing-instruction-target">xml</span> <span class="nxml-attribute-local-name">version</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">1.0</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">encoding</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">UTF-8</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-processing-instruction-delimiter">?&gt;</span>

<span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">stylesheet</span> <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">xsl</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">http://www.w3.org/1999/XSL/Transform</span><span class="nxml-namespace-attribute-value-delimiter">"</span> 
                <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">xs</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">http://www.w3.org/2001/XMLSchema</span><span class="nxml-namespace-attribute-value-delimiter">"</span>
                <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">http</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">http://expath.org/ns/http-client</span><span class="nxml-namespace-attribute-value-delimiter">"</span>
                <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">impl</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">urn:X-EXPath:httpclient:samples:exist:impl</span><span class="nxml-namespace-attribute-value-delimiter">"</span>
                <span class="nxml-attribute-local-name">exclude-result-prefixes</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">#all</span><span class="nxml-attribute-value-delimiter">"</span>
                <span class="nxml-attribute-local-name">version</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">2.0</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">import</span> <span class="nxml-attribute-local-name">href</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">http://expath.org/ns/http-client.xsl</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">output</span> <span class="nxml-attribute-local-name">indent</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">yes</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> credentials </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">param</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">username</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">'guest'</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">param</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">password</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">'guest'</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> document to retrieve, and document to upload </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">param</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">in</span><span class="nxml-attribute-value-delimiter">"</span>  <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">'/db/tmp/in.xml'</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">param</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">out</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">'/db/tmp/out.xml'</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> URI of the REST interface of eXist instance </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">param</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">rest</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">'http://localhost:8080/exist/rest'</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> main template: retrieve a doc, transform it and
        upload the result </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">main</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">variable</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">doc</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
         <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">apply-templates</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">impl:get-in()</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">variable</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">sequence</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">impl:put-out($doc)</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> the transform rules </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span> <span class="nxml-attribute-local-name">match</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">who</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-local-name">hello</span><span class="nxml-tag-delimiter">&gt;</span>
         <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">value-of</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">.</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-local-name">hello</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> retrieve the input doc </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">function</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">impl:get-in</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">as</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">document-node()</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">variable</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">req</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">as</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">element()</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
         <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">http</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">request</span> <span class="nxml-attribute-local-name">href</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">{ $rest }{ $in }</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">method</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">get</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">username</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">{ $username }</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">password</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">{ $password }</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">auth-method</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">basic</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">send-authorization</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">true</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">variable</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> error checking is left as an exercise </span><span class="nxml-comment-delimiter">--&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">sequence</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">http:send-request($req)[2]</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">function</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> upload the output doc </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">function</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">impl:put-out</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">as</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">item()*</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">param</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">doc</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">as</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">document-node()</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">variable</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">req</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">as</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">element()</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
         <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">http</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">request</span> <span class="nxml-attribute-local-name">href</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">{ $rest }{ $out }</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">method</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">put</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">username</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">{ $username }</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">password</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">{ $password }</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">auth-method</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">basic</span><span class="nxml-attribute-value-delimiter">"</span>
                       <span class="nxml-attribute-local-name">send-authorization</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">true</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
            <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">http</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">body</span> <span class="nxml-attribute-local-name">media-type</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">application/xml</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
         <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">http</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">request</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">variable</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> error checking is left as an exercise </span><span class="nxml-comment-delimiter">--&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">sequence</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">http:send-request($req, (), $doc)</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">function</span><span class="nxml-tag-delimiter">&gt;</span>

<span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">stylesheet</span><span class="nxml-tag-delimiter">&gt;</span>
</pre>

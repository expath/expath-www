<pre xmlns="http://www.w3.org/1999/xhtml">
<span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">stylesheet</span> <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">xsl</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">http://www.w3.org/1999/XSL/Transform</span><span class="nxml-namespace-attribute-value-delimiter">"</span>
                <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">xs</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">http://www.w3.org/2001/XMLSchema</span><span class="nxml-namespace-attribute-value-delimiter">"</span>
                <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">soap</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">http://schemas.xmlsoap.org/soap/envelope/</span><span class="nxml-namespace-attribute-value-delimiter">"</span>
                <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">wsx</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">http://www.webservicex.net</span><span class="nxml-namespace-attribute-value-delimiter">"</span>
                <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">http</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">http://www.expath.org/mod/http-client</span><span class="nxml-namespace-attribute-value-delimiter">"</span>
                <span class="nxml-namespace-attribute-xmlns">xmlns</span><span class="nxml-namespace-attribute-colon">:</span><span class="nxml-namespace-attribute-prefix">http-java</span>=<span class="nxml-namespace-attribute-value-delimiter">"</span><span class="nxml-namespace-attribute-value">java:org.expath.saxon.HttpClient</span><span class="nxml-namespace-attribute-value-delimiter">"</span>
                <span class="nxml-attribute-local-name">exclude-result-prefixes</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">#all</span><span class="nxml-attribute-value-delimiter">"</span>
                <span class="nxml-attribute-local-name">version</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">2.0</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> The result is text </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">output</span> <span class="nxml-attribute-local-name">method</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">text</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> To serialize with saxon:serialize() </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">output</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">default</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">indent</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">yes</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">omit-xml-declaration</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">yes</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> The Web service endpoint </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">param</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">endpoint</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">as</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">xs:string</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">
       'http://www.webservicex.net/WeatherForecast.asmx'</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> The element representing the HTTP request (with the SOAP envelope) </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">variable</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">request</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">as</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">element()</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">http</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">request</span> <span class="nxml-attribute-local-name">method</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">post</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
         <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">http</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">header</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">SOAPAction</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">value</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">http://www.webservicex.net/GetWeatherByPlaceName</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
         <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">http</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">body</span> <span class="nxml-attribute-local-name">content-type</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">application/xml</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
            <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">soap</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">Envelope</span><span class="nxml-tag-delimiter">&gt;</span>
               <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">soap</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">Header</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
               <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">soap</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">Body</span><span class="nxml-tag-delimiter">&gt;</span>
                  <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">wsx</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">GetWeatherByPlaceName</span><span class="nxml-tag-delimiter">&gt;</span>
                     <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">wsx</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">PlaceName</span><span class="nxml-tag-delimiter">&gt;</span><span class="nxml-text">NEW YORK</span><span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">wsx</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">PlaceName</span><span class="nxml-tag-delimiter">&gt;</span>
                  <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">wsx</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">GetWeatherByPlaceName</span><span class="nxml-tag-delimiter">&gt;</span>
               <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">soap</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">Body</span><span class="nxml-tag-delimiter">&gt;</span>
            <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">soap</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">Envelope</span><span class="nxml-tag-delimiter">&gt;</span>
         <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">http</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">body</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">http</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">request</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">variable</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> The main template </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span> <span class="nxml-attribute-local-name">match</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">/</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">main</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> Send the HTTP request and get the result back </span><span class="nxml-comment-delimiter">--&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">variable</span> <span class="nxml-attribute-local-name">name</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">response</span><span class="nxml-attribute-value-delimiter">"</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">http-java:send-request($request, $endpoint)</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> Check for error in the HTTP layer </span><span class="nxml-comment-delimiter">--&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">if</span> <span class="nxml-attribute-local-name">test</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">$response[1]/xs:integer(@status) ne 200</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
         <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">sequence</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">
             error((), $response[1]/concat('HTTP error: ', @status, ' ', @message))</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">if</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> Apply templates to the SOAP's payload </span><span class="nxml-comment-delimiter">--&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">apply-templates</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">$response[2]/soap:Envelope/soap:Body/*/*</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> Handle the payload </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span> <span class="nxml-attribute-local-name">match</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">wsx:GetWeatherByPlaceNameResult</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span><span class="nxml-text">Place: </span><span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">value-of</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">wsx:PlaceName</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span><span class="nxml-char-ref-delimiter">&amp;#</span><span class="nxml-char-ref-number">10</span><span class="nxml-char-ref-delimiter">;</span><span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">apply-templates</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">wsx:Details/*</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span><span class="nxml-tag-delimiter">&gt;</span>

   <span class="nxml-comment-delimiter">&lt;!--</span><span class="nxml-comment-content"> Handle a single forecast </span><span class="nxml-comment-delimiter">--&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span> <span class="nxml-attribute-local-name">match</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">wsx:WeatherData[*]</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span><span class="nxml-text">  - </span><span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">value-of</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">wsx:Day</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span><span class="nxml-text">:</span><span class="nxml-char-ref-delimiter">&amp;#</span><span class="nxml-char-ref-number">09</span><span class="nxml-char-ref-delimiter">;</span><span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">value-of</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">wsx:MinTemperatureC</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span><span class="nxml-text"> - </span><span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">value-of</span> <span class="nxml-attribute-local-name">select</span>=<span class="nxml-attribute-value-delimiter">"</span><span class="nxml-attribute-value">wsx:MaxTemperatureC</span><span class="nxml-attribute-value-delimiter">"</span><span class="nxml-tag-slash">/</span><span class="nxml-tag-delimiter">&gt;</span>
      <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span><span class="nxml-char-ref-delimiter">&amp;#</span><span class="nxml-char-ref-number">10</span><span class="nxml-char-ref-delimiter">;</span><span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">text</span><span class="nxml-tag-delimiter">&gt;</span>
   <span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">template</span><span class="nxml-tag-delimiter">&gt;</span>

<span class="nxml-tag-delimiter">&lt;</span><span class="nxml-tag-slash">/</span><span class="nxml-element-prefix">xsl</span><span class="nxml-element-colon">:</span><span class="nxml-element-local-name">stylesheet</span><span class="nxml-tag-delimiter">&gt;</span>
</pre>
